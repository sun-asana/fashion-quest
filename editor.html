<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Fashion Quest: Ultra Editor</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #fff5f8; padding: 20px; display: flex; justify-content: center; }
        .editor-card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 100%; max-width: 550px; }
        h2 { color: #ff4081; text-align: center; }
        label { font-weight: 600; display: block; margin-top: 15px; }
        input, select { width: 100%; padding: 12px; margin-top: 5px; border: 2px solid #ffe0ea; border-radius: 10px; box-sizing: border-box; }
        
        /* –ó–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ */
        #drop-zone {
            border: 2px dashed #ff4081;
            padding: 25px;
            text-align: center;
            border-radius: 15px;
            margin-top: 15px;
            background: #fff9fb;
            color: #ff4081;
            cursor: pointer;
            transition: 0.3s;
        }
        #drop-zone.hover { background: #ffe4ee; }
        #preview-img { max-width: 100%; max-height: 150px; margin-top: 10px; display: none; border-radius: 10px; }

        #gen-btn { width: 100%; padding: 15px; background: #ff4081; color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: bold; margin-top: 25px; }
        code { display: block; background: #2d3436; color: #fab1a0; padding: 15px; border-radius: 10px; font-size: 10px; white-space: pre-wrap; margin-top: 10px; max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="editor-card">
        <h2>üëó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ó–∞–¥–∞–Ω–∏—è</h2>
        
        <label>–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞:</label>
        <input type="text" id="q" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–µ—à–∏ –∑–∞–¥–∞—á—É –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ">
        
        <label>–ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–¥–∞–Ω–∏—è (–ø–µ—Ä–µ—Ç–∞—â–∏ —Å—é–¥–∞ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏):</label>
        <div id="drop-zone">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ PNG/JPG —Ñ–∞–π–ª —Å—é–¥–∞</div>
        <input type="file" id="file-input" style="display:none" accept="image/*">
        <center><img id="preview-img"></center>

        <label>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</label>
        <input type="text" id="a" placeholder="–û—Ç–≤–µ—Ç">

        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–∞–≥—Ä–∞–¥—ã:</label>
        <select id="type">
            <option value="all">–í—Å—ë —Å—Ä–∞–∑—É</option>
            <option value="top">–í–µ—Ä—Ö (–û–¥–µ–∂–¥–∞)</option>
            <option value="bottom">–ù–∏–∑ (–ë—Ä—é–∫–∏/–Æ–±–∫–∏)</option>
            <option value="shoes">–û–±—É–≤—å</option>
            <option value="acc">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
        </select>

        <button id="gen-btn" onclick="generate()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
        
        <div id="result" style="display:none">
            <code id="out"></code>
        </div>
    </div>

    <script>
        let base64Image = "";
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const preview = document.getElementById('preview-img');

        // –ö–ª–∏–∫ –ø–æ –∑–æ–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞
        dropZone.onclick = () => fileInput.click();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
        dropZone.ondragover = (e) => { e.preventDefault(); dropZone.classList.add('hover'); };
        dropZone.ondragleave = () => dropZone.classList.remove('hover');
        dropZone.ondrop = (e) => {
            e.preventDefault();
            dropZone.classList.remove('hover');
            handleFile(e.dataTransfer.files[0]);
        };

        fileInput.onchange = (e) => handleFile(e.target.files[0]);

        function handleFile(file) {
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                base64Image = e.target.result;
                preview.src = base64Image;
                preview.style.display = "block";
                dropZone.innerText = "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!";
            };
            reader.readAsDataURL(file);
        }

        function generate() {
            const q = document.getElementById('q').value;
            const a = document.getElementById('a').value;
            const type = document.getElementById('type').value;
            const url = "https://sun-asana.github.io/fashion-quest/index.html";
            
            // –ö–æ–¥ –∫–Ω–æ–ø–∫–∏ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π
            const code = `<div style="width:100%;height:100%"><iframe src="${url}" style="width:100%;height:100%;border:none;position:fixed;top:0;left:0;pointer-events:none;z-index:9999" id="fq-engine"></iframe><button style="background:#ff4081;color:#fff;border:none;padding:15px 30px;border-radius:50px;font-family:sans-serif;font-weight:700;cursor:pointer;pointer-events:auto" onclick="const e=document.getElementById('fq-engine');e.style.pointerEvents='auto';e.contentWindow.postMessage({type:'openTask',q:'${q}',a:'${a}',m:100,img:'${base64Image}',shopType:'${type}'},'*')">‚ú® –ù–∞—á–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ ‚ú®</button></div>`;
            
            document.getElementById('out').innerText = code;
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>
