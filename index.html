<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="fq-overlay" class="hidden">
        <div id="fq-modal">
            <h2 id="modal-title"></h2>
            <div id="modal-content"></div>
            <button id="modal-btn">Ответить</button>
        </div>
    </div>

    <script src="engine.js"></script>
    <script>
        // Ждем команды от кнопки из Genially
        window.addEventListener('message', function(event) {
            console.log("Получено сообщение:", event.data); // Для отладки
            const data = event.data;
            if (data.type === 'openTask') {
                window.openTask(data.q, data.a, data.m);
            }
        });

        const overlay = document.getElementById('fq-overlay');
        const content = document.getElementById('modal-content');
        const title = document.getElementById('modal-title');
        const btn = document.getElementById('modal-btn');

        window.openTask = function(question, correctAnswer, reward) {
            title.innerText = "Fashion Вопрос";
            content.innerHTML = `
                <p style="margin-bottom:15px;">${question}</p>
                <input type="text" id="user-answer" style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd;" placeholder="Ваш ответ...">
            `;
            overlay.classList.remove('hidden');
            
            btn.onclick = function() {
                const val = document.getElementById('user-answer').value;
                if(val && val.toLowerCase().trim() === correctAnswer.toLowerCase().trim()) {
                    window.FQ.addMoney(reward);
                    alert("Верно! + " + reward + " монет");
                    // Скрываем окно и возвращаем управление Genially
                    overlay.classList.add('hidden');
                    window.parent.postMessage({type: 'close'}, '*');
                } else {
                    alert("Упс! Неверно. Попробуй еще раз.");
                }
            };
        };
    </script>
</body>
</html>
